parameters:
  buildConfiguration: ''

jobs:
  - job: build
    displayName: Build

    pool:
      vmImage: ubuntu-latest

    steps:
    - task: UseDotNet@2
      inputs:
        packageType: 'sdk'
        version: '5.0.x'
        includePreviewVersions: true
        performMultiLevelLookup: true

    - task: DotNetCoreCLI@2
      displayName: Build Package
      inputs:
        command: 'build'
        arguments: '--configuration ${{ parameters.buildConfiguration }} /p:PackageVersion=$(Build.BuildNumber)'

    - task: Bash@3
      displayName: Environment Variables
      inputs:
        targetType: 'inline'
        script: 'env | sort'

    - task: DotNetCoreCLI@2
      displayName: Push Package
      inputs:
        command: 'push'
        packagesToPush: './Illusion.Common/bin/Release/*.nupkg'
        nuGetFeedType: 'internal'
        publishVstsFeed: 'cb5e5c0b-aa1d-4688-a3ff-e65476c9e30a/d99cfdbb-c33d-4667-9065-a67e001d5e66'
